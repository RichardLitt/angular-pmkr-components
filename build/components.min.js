/*
pmkr.components v0.0.0
https://github.com/m59peacemaker/angular-pmkr-components
License: MIT
Author: Johnny Hauser
File created: 8.21.2014
*/

angular.module("pmkr.components",["pmkr.components.filters","pmkr.components.services","pmkr.components.directives"]),angular.module("pmkr.components.directives",["pmkr.pristineOriginal","pmkr.validateCustom"]),angular.module("pmkr.pristineOriginal",[]).directive("pmkrPristineOriginal",[function(){var r={restrict:"A",require:"ngModel",link:function(r,n,t,e){var i=null;r.$watch(function(){return e.$viewValue},function(r){null===i&&(i=e.$isEmpty(r)?"":r.toString()),i===r&&e.$setPristine()})}};return r}]),angular.module("pmkr.validateCustom",["pmkr.debounce"]).directive("pmkrValidateCustom",["$q","pmkr.debounce",function(r,n){var t={restrict:"A",require:"ngModel",priority:1,link:function(r,t,e,i){function a(r){return m?void 0:(l.validating=!0,o.fn(r))}function u(r){return l.valid=l.invalid=!1,o.gate&&(m=o.gate(r,i))?void(l.pending=l.validating=!1):(l.pending=!0,void c(r).then(function(n){m||(l.checkedValue=r,p=l.valid=n,l.invalid=!p,i.$validate(),l.pending=l.validating=!1)}))}var o=r.$eval(e.pmkrValidateCustom),l={};o.props&&(r[o.props]=l);var p,m=!1;i.$validators[o.name]=function(){return p};var f=n(a,o.wait),c=n.latest(f);r.$watch(function(){return i.$viewValue},u)}};return t}]),angular.module("pmkr.components.filters",["pmkr.offset","pmkr.partition","pmkr.shuffle","pmkr.slugify","pmkr.textOnly"]),angular.module("pmkr.offset",[]).filter("pmkr.offset",[function(){var r=function(r,n){return r&&r.length?(n=parseInt(n,10),r.slice(n)):r};return r}]),angular.module("pmkr.partition",["pmkr.filterStabilize"]).filter("pmkr.partition",["pmkr.filterStabilize",function(r){var n=r("pmkr.partition",function(r,n){for(var t=[],e=0;e<r.length;e+=n)t.push(r.slice(e,e+n));return t});return n}]),angular.module("pmkr.shuffle",["pmkr.filterStabilize"]).filter("pmkr.shuffle",["pmkr.filterStabilize",function(r){function n(r){for(var n=r.length;0!==n;){var t=Math.floor(Math.random()*n);n-=1;var e=r[n];r[n]=r[t],r[t]=e}return r}var t=r("pmkr.shuffle",function(r){return"string"==typeof r?(r=r.split(""),n(r),r.join("")):void n(r)});return t}]),angular.module("pmkr.slugify",[]).filter("pmkr.slugify",[function(){var r=function(r){var n=r.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"");return n};return r}]),angular.module("pmkr.textOnly",[]).filter("pmkr.textOnly",function(){var r=function(r){var n=document.createElement("div");n.innerHTML=r;var t=n.textContent;return t=t.replace(/(\w)([.!?]+)(\w)/gi,"$1$2 $3")};return r}),angular.module("pmkr.components.services",["pmkr.debounce","pmkr.filterStabilize"]),angular.module("pmkr.debounce",[]).factory("pmkr.debounce",["$timeout","$q",function(r,n){function t(t,e){function i(){var i=n.defer(),u=this,o=arguments;return r.cancel(a),a=r(function(){i.resolve(t.apply(u,o))},e),i.promise}var a;return i}function e(t,e){function i(){var i=n.defer(),u=this,o=arguments;return a||i.resolve(t.apply(u,o)),r.cancel(a),a=r(function(){a=null},e),i.promise}var a;return i}function i(r){function t(){var t=e=JSON.stringify(arguments),i=n.defer();return r.apply(this,arguments).then(function(r){e===t&&i.resolve(r)},function(r){e===t&&i.reject(r)}),i.promise}var e;return t}var a=function(){return t.apply(this,arguments)};return a.immediate=function(){return e.apply(this,arguments)},a.latest=function(){return i.apply(this,arguments)},a}]),angular.module("pmkr.filterStabilize",[]).factory("pmkr.filterStabilize",[function(){var r={},n=function(n,t){var e=function(){for(var e=[],i=0;i<arguments.length;++i)e.push(arguments[i]);var a=e[0];if(!a)return a;r[n]=r[n]||{};var u=JSON.stringify(e),o=r[n][u];if(o)return o;e[0]=angular.copy(a);var l=t.apply(this,e)||e[0];return r[n][u]=l,l};return e};return n}]);